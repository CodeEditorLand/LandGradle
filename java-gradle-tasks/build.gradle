plugins {
    id 'java'
    id 'application'
    id 'jacoco'
    id 'com.github.johnrengelman.shadow' version '5.2.0'
}

repositories {
    mavenCentral()
    maven {
        url 'https://repo.gradle.org/gradle/libs-releases'
    }
}

sourceSets {
    libsDirName = 'lib'
}

dependencies {
    compile 'org.gradle:gradle-tooling-api:6.0.1'
    compile 'com.eclipsesource.minimal-json:minimal-json:0.9.5'
    runtimeOnly 'org.slf4j:slf4j-simple:1.7.29'
    testImplementation 'junit:junit:4.12'
}

application {
    mainClassName = 'com.github.badsyntax.gradletasks.CliApp'
}

shadowJar {
    minimize()
}

task generateLib(type: Copy) {
    dependsOn build

    from file("$buildDir/lib/${project.name}-all.jar")
    into file("$buildDir/../../lib/${project.name}-all.jar")

    from "$buildDir/scriptsShadow/${project.name}", "$buildDir/scriptsShadow/${project.name}.bat"
    into "$buildDir/../../lib"
}
