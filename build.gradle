plugins {
    id 'java'
    id 'com.google.protobuf' version '0.8.12'
}

allprojects {
    group = 'vscode-gradle'
}

project.ext.set('grpcVersion', '1.28.1')
project.ext.set('protobufVersion', '3.11.0')
project.ext.set('protocVersion', project.protobufVersion)

subprojects {
    apply plugin: 'java'
    apply plugin: 'com.google.protobuf'

    repositories {
        maven {
            url "https://maven-central.storage-download.googleapis.com/repos/central/data/"
        }
        maven {
            url 'https://repo.gradle.org/gradle/libs-releases'
        }
        mavenCentral()
        mavenLocal()
    }

    protobuf {
        protoc {
            artifact = "com.google.protobuf:protoc:${protocVersion}"
        }
    }

    clean {
        delete protobuf.generatedFilesBaseDir
    }

    tasks.withType(JavaCompile) {
        options.encoding = 'UTF-8'
    }
}
